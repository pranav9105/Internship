{
  "entities": {
    "Destination": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Destination",
      "type": "object",
      "description": "Represents a travel destination.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Destination entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the destination."
        },
        "description": {
          "type": "string",
          "description": "Brief description of the destination."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image representing the destination.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "imageUrl"
      ]
    },
    "TravelPackage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TravelPackage",
      "type": "object",
      "description": "Represents a travel or hotel package.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the TravelPackage entity."
        },
        "destinationId": {
          "type": "string",
          "description": "Reference to Destination. (Relationship: Destination 1:N TravelPackage)"
        },
        "name": {
          "type": "string",
          "description": "Name of the travel package."
        },
        "description": {
          "type": "string",
          "description": "Detailed itinerary and description of the package."
        },
        "price": {
          "type": "number",
          "description": "Price of the package."
        },
        "duration": {
          "type": "string",
          "description": "Duration of the travel package (e.g., 7 days, 14 nights)."
        }
      },
      "required": [
        "id",
        "destinationId",
        "name",
        "description",
        "price",
        "duration"
      ]
    },
    "BookingInquiry": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "BookingInquiry",
      "type": "object",
      "description": "Represents a booking inquiry submitted by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the BookingInquiry entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N BookingInquiry)"
        },
        "packageId": {
          "type": "string",
          "description": "Reference to TravelPackage. (Relationship: TravelPackage 1:N BookingInquiry)"
        },
        "inquiryDate": {
          "type": "string",
          "description": "Date the inquiry was submitted.",
          "format": "date-time"
        },
        "message": {
          "type": "string",
          "description": "Message or details provided by the user in the inquiry."
        }
      },
      "required": [
        "id",
        "userId",
        "packageId",
        "inquiryDate",
        "message"
      ]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the UserProfile entity."
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "savedDestinationIds": {
          "type": "array",
          "description": "References to Destinations saved by the user. (Relationship: UserProfile N:N Destination)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    },
    "Recommendation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Recommendation",
      "type": "object",
      "description": "Represents a personalized destination recommendation for a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Recommendation entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N Recommendation)"
        },
        "destinationId": {
          "type": "string",
          "description": "Reference to Destination. (Relationship: Destination 1:N Recommendation)"
        },
        "recommendationDate": {
          "type": "string",
          "description": "Date the recommendation was generated.",
          "format": "date-time"
        },
        "reason": {
          "type": "string",
          "description": "Reasoning behind the recommendation (e.g., based on past inquiries, user preferences)."
        }
      },
      "required": [
        "id",
        "userId",
        "destinationId",
        "recommendationDate",
        "reason"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/destinations/{destinationId}",
        "definition": {
          "entityName": "Destination",
          "schema": {
            "$ref": "#/backend/entities/Destination"
          },
          "description": "Stores travel destinations.  The document ID is the destinationId.",
          "params": [
            {
              "name": "destinationId",
              "description": "The unique identifier for the destination."
            }
          ]
        }
      },
      {
        "path": "/travelPackages/{travelPackageId}",
        "definition": {
          "entityName": "TravelPackage",
          "schema": {
            "$ref": "#/backend/entities/TravelPackage"
          },
          "description": "Stores travel packages. The document ID is the travelPackageId.",
          "params": [
            {
              "name": "travelPackageId",
              "description": "The unique identifier for the travel package."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/bookingInquiries/{bookingInquiryId}",
        "definition": {
          "entityName": "BookingInquiry",
          "schema": {
            "$ref": "#/backend/entities/BookingInquiry"
          },
          "description": "Stores booking inquiries submitted by users.  Parent path ensures ownership. The document ID is the bookingInquiryId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "bookingInquiryId",
              "description": "The unique identifier for the booking inquiry."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profiles. The document ID is the userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/recommendations/{recommendationId}",
        "definition": {
          "entityName": "Recommendation",
          "schema": {
            "$ref": "#/backend/entities/Recommendation"
          },
          "description": "Stores personalized destination recommendations for users. Parent path ensures ownership. The document ID is the recommendationId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "recommendationId",
              "description": "The unique identifier for the recommendation."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure security, scalability, and ease of debugging, following the principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), and QAPs (Rules are not Filters). Authorization Independence is achieved through denormalization. For example, if access to `BookingInquiry` documents needed to depend on user profile attributes, these attributes would be copied into the `BookingInquiry` documents to avoid using `get()` calls in security rules. Structural Segregation is applied by keeping user-specific data (like `UserProfile` and `BookingInquiry`) in separate collections under the `/users/{userId}` path, while global data like `Destination` and `TravelPackage` are stored in root-level collections. Access Modeling utilizes path-based ownership for user-owned data and membership maps for collaborative scenarios, if applicable in future updates. The structure supports QAPs by ensuring that list operations can be secured without filtering based on document data; this is achieved by segregating data based on access control requirements into different collections. Invariants, such as ownership and timestamps, can be enforced through security rules. The design also incorporates explicit state modeling (if states are introduced later) and a predictable schema, avoiding dynamic keys and enforcing strict naming conventions."
  }
}